<!DOCTYPE html>
<!--HTML5-->
<html lang="ja">

<head>
    <!-- meta設定 -->
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
    <meta http-equiv="Content-Script-Type" content="text/javascript" charset="UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/ccs" charset="UTF-8" />
    <meta name="robots" content="noindex,nofollow" />

    <!-- Global site tag (gtag.js) - Google Analytics by Zacky -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-163335381-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'UA-163335381-1');
    </script>

    <!-- PWA設定 -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- jQuery/UI -->
    <script src="https://code.jquery.com/jquery-3.0.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.js"></script>
    <!-- jQuery依存 -->

    <!-- Bootstrap 5.0.0 alpha -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/css/bootstrap.min.css"
        integrity="sha384-r4NyP46KrjDleawBgD5tp8Y7UzmLA05oM1iAEQ17CSuDqnUK2+k9luXQOfXJCJ4I" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-popRpmFF9JQgExhfw5tZT4I9/CI5e2QcuUZPOVXb1m7qUmeR2b50u+YFEYe1wgzy"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/js/bootstrap.min.js"
        integrity="sha384-oesi62hOLfzrys4LxRF63OJCXdXDipiYWBnvTl9Y9/TRlw5xlKIEHpNyvvDShgf/"
        crossorigin="anonymous"></script>
    <!-- ScrollHint -->
    <link rel="stylesheet" href="https://unpkg.com/scroll-hint@latest/css/scroll-hint.css">
    <script src="https://unpkg.com/scroll-hint@latest/js/scroll-hint.min.js"></script>

    <!-- Google Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Icons" rel="stylesheet">

    <script>
        window.addEventListener("load", function () {
            /* jQuery @onload */
            $(".jq_accordion").accordion({
                active: false,
                collapsible: true,
                heightStyle: "content"
            });
        });
    </script>

    <style>
        @import "../zScript/common.css";

        * {
            vertical-align: middle;
        }

        .jq_accordion>a {
            display: block;
            text-decoration: none;
        }

        .jq_accordion:nth-child(2n) {
            margin-left: 0.2em;
        }

        .chkbx_disptoggle {
            display: none;
        }

        .chkbx_disptoggle:checked+* {
            display: none;
        }
    </style>
    <base target="_blank">
    <title>KG Dashboard</title>
</head>

<body>
    <nav class="navbar navbar-dark bg-dark sticky-top mb-2">
        <div class="container-fluid d-flex justify-content-between">
            <a href="#" target="_self" class="navbar-brand">KG Dashboard</a>
            <div>
                <div>
                    <span class="btn disabled text-light d-none d-lg-inline">Microsoft Apps</span>
                    <div class="btn-group" role="group">
                        <a class="btn btn-outline-light" href="https://teams.microsoft.com/">Teams</a>
                        <a class="btn btn-outline-light" href="https://outlook.office.com/mail/">Outlook</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row g-2">
            <section class="col-12 col-md-3 col-lg-2 sidebar g-2">
                <div class="row g-2">

                    <!-- menu -->
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header"><span class="material-icons">
                                    list
                                </span>Menu</div>
                            <div class="card-body">
                                <div class="card-text">
                                    <div class="jq_accordion">
                                        <a class="h4">KG links</a>
                                        <ul>
                                            <li>
                                                <a href="https://jsh.kgef.ac.jp/">学校サイト</a>
                                                <ul>
                                                    <li><a href="https://jsh.kgef.ac.jp/kg/">総合TOP</a></li>
                                                    <li><a href="https://jsh.kgef.ac.jp/kjs/">中学TOP</a></li>
                                                    <li><a href="https://jsh.kgef.ac.jp/khs/">高校TOP</a></li>
                                                    <li><a href="https://jsh.kgef.ac.jp/schoolbus/">スクールバス</a></li>
                                                    <li><a href="https://jsh.kgef.ac.jp/wp-admin/">◆wp-admin</a></li>
                                                </ul>
                                            </li>
                                            <li>YouTube関連
                                                <ul>
                                                    <li><a
                                                            href="https://www.youtube.com/channel/UCZs_H9a6xIilg4v49m0l7UQ">広報ch</a>
                                                    </li>
                                                    <li><a
                                                            href="https://www.youtube.com/channel/UCpYFKgCIpJGbCrj8U8ZXaNQ">生徒会ch</a>
                                                    </li>
                                                    <li><a
                                                            href="https://www.youtube.com/channel/UC1sOiMc9ufHSjkIERjVRtKg">学内向けch</a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                WEBアクセス解析<br />
                                                <a
                                                    href="https://datastudio.google.com/reporting/1WBv4jjidJR__pI82WWIl5bPumkks4CPP">
                                                    Google DataPortal/Analytics</a>
                                            </li>
                                            <li><a href="https://fes.kgef.ac.jp/2020jsh/index.html">五峯祭2020</a>
                                                <ul>
                                                    <li><a
                                                            href="https://fes.kgef.ac.jp/2020jsh/index.html?debug">debug用</a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                校内限定(intra)
                                                <ul>
                                                    <li><a href="http://192.168.20.41/iraimenu.HTM">支払依頼</a></li>
                                                    <li><a href="http://192.168.20.100/hs/">旧・相談システム</a></li>
                                                    <li><a href="./KG_doc/KobetsuSoudanIkkatsu.html">一括印刷ツール(旧システム用)</a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <a class="h4">Tools</a>
                                        <ul>
                                            <li><a href="https://mail.google.com/">Gmail</a></li>
                                            <li><a href="http://mail.yahoo.co.jp/">Yahoo!メール</a></li>
                                            <li><a href="https://trello.com/">Trello</a></li>
                                            <li><a href="https://feedly.com/">Feedly</a></li>
                                            <li><a href="https://discordapp.com/activity">discord</a></li>
                                            <li><a href="https://slack.com/">slack</a></li>
                                            <li><a href="https://www.evernote.com/client/web">Evernote</a></li>
                                            <li><a href="https://archive.org/">Internet Archive</a></li>
                                            <li><a href="https://www.wolframalpha.com/">WolframAlpha</a></li>
                                            <li><a href="https://app.diagrams.net/">diagrams.net</a><br />(draw.io)</li>
                                            <li><a href="https://www.mathcha.io/editor">Mathcha</a></li>
                                            <li><a href="https://www.geogebra.org/?lang=ja">Geogebra</a></li>
                                            <li><a href="https://grapes-light.app/">GRAPES-light</a></li>
                                            <li><a href="https://picky-pics.com/">Picky-Pics</a></li>
                                        </ul>
                                        <a class="h4">Log</a>
                                        <div>
                                            <dl>
                                                <dt>12.12sat</dt>
                                                <dd>レイアウトfix</dd>
                                                <dt>11.24tue</dt>
                                                <dd>クラス別健康観察fix</dd>
                                                <dt>11.22sun</dt>
                                                <dd>COVID-19info追加</dd>
                                                <dd>背景機能追加</dd>
                                                <dt>11.20fri</dt>
                                                <dd>スマホ表示最適化</dd>
                                                <dd>天気予報ウィジェットを<br />自作版に変更</dd>
                                                <dd>Timerウィジェット追加</dd>
                                                <dt>11.19thu</dt>
                                                <dd>ページリニューアル</dd>
                                            </dl>
                                        </div>
                                    </div>
                                    <div class="text-center">
                                        <!--  trigger modal -->
                                        <p>
                                            <a role="button" class="btn btn-outline-primary" data-toggle="modal"
                                                data-target="#RenewInfo">更新メモ</a>
                                            <a role="button" class="btn btn-outline-secondary"
                                                href="./index1118.html">旧サイト</a>
                                        </p>
                                        <!-- Modal -->
                                        <div class="modal fade" id="RenewInfo" tabindex="-1"
                                            aria-labelledby="RenewInfoLabel" aria-hidden="true">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="RenewInfoLabel">更新情報</h5>
                                                        <button type="button" class="close" data-dismiss="modal"
                                                            aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        天気予報ウィジェットの動作が怪しかったので、自作版に変更しました。<br />
                                                        気象庁からのデータを利用しているので、精度は上がるはずです。<br />
                                                        （デザインはイマイチですが…）
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-primary"
                                                            data-dismiss="modal">Close</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- お知らせ -->
                    <div class="col-12">
                        <div class="card col-12">
                            <div class="card-header"><span class="material-icons">
                                    info
                                </span>Info</div>
                            <div class="card-body">
                                <div>
                                    <h5 class="card-title">アプリ版KG Dashboard</h5>
                                    <p>下記リンク先から簡易的なアプリ機能(PWA)を実験中です。<br />
                                        <a href="./teachers/">KG Dashboard for Teachers</a>
                                    </p>
                                    <hr>
                                </div>
                                <h5 class="card-title">2021年の祝日移動</h5>
                                <p>
                                    2020年12月に制定されたので、ほとんどのカレンダーは未反映のはずです。ご注意ください。
                                    なお、対象は「海の日・スポーツの日・山の日」です。<br />
                                    <a
                                        href="https://www.kantei.go.jp/jp/headline/tokyo2020/shukujitsu.html">2021年の祝日移動について(内閣官房)</a>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

            </section>

            <section class="col-12 col-md-9 col-lg-10 col-xl-8">

                <div class="row g-2">

                    <!-- 健康観察 -->
                    <div class="col-12 col-lg-6">
                        <div class="card">
                            <div class="card-header"><span class="material-icons">
                                    health_and_safety
                                </span>健康観察</div>
                            <div class="card-body">
                                <h5 class="card-title">生徒健康観察</h5>
                                <div class="alert alert-primary" role="alert">
                                    <h4 class="alert-heading">新・健康観察</h4>
                                    <h6 class="text-muted">2021.04.05より利用開始</h6>
                                    <div class="text-center">
                                        <a class="btn btn-outline-primary"
                                            href="https://forms.office.com/Pages/ResponsePage.aspx?id=z327fGQzzUGZdki7xIvYKpHVAnr2D4tFhVOJ99MGdnVURTRXNlBLM0ZMUUpMV0JaQzdRVTFHM005SyQlQCN0PWcu"
                                            role="button">生徒回答フォーム</a>
                                        <a class="btn btn-primary"
                                            href="https://kgefac.sharepoint.com/sites/msteams_1d13d1/_layouts/15/Doc.aspx?sourcedoc={7ddd4ab2-f6e4-48de-bc81-b9069dae2ca7}&action=embedview&wdAllowInteractivity=False&AllowTyping=True&wdHideGridlines=True&wdInConfigurator=True"
                                            role="button">教員確認用</a>
                                    </div>
                                </div>
                                <div class="alert alert-warning" role="alert">
                                    <h4 class="alert-heading">カスタム名票</h4>
                                    従来の名票をそのまま移行したため、「卒業生＝アカウント抹消済み」等で表示エラーになる場合があります。<br />
                                    新名簿の登録を希望する場合は、カスタム名票登録シートの黄色部分に必要事項を入力し、ご提出ください。
                                    <div class="text-center">
                                        <a class="btn btn-outline-primary"
                                            href="https://teams.microsoft.com/_#/school/files/Teams%E5%82%99%E5%BF%98%E9%8C%B2?threadId=19%3A78b74f6be33643508b25545be068ff8f%40thread.tacv2&ctx=channel&context=%25E9%2585%258D%25E5%25B8%2583%25E8%25B3%2587%25E6%2596%2599&rootfolder=%252Fsites%252Fmsteams_1d13d1%252FShared%2520Documents%252FTeams%25E5%2582%2599%25E5%25BF%2598%25E9%258C%25B2%252F%25E5%2585%25A8%25E6%25A0%25A1%25E3%2582%25A2%25E3%2583%25B3%25E3%2582%25B1%25E3%2583%25BC%25E3%2583%2588%252F%25E9%2585%258D%25E5%25B8%2583%25E8%25B3%2587%25E6%2596%2599"
                                            role="button">カスタム名票登録2021</a><br/>
                                            職員会議 ＞ Teams
                                    </div>
                                </div>




                                <div class="alert alert-secondary" role="alert">
                                    <h4 class="alert-heading">旧・健康観察</h4>
                                    <h6 class="text-muted">2021.04.04まで</h6>
                                    <div class="text-center m-2">
                                        <a class="btn btn-outline-primary" role="button"
                                            href="https://forms.office.com/Pages/ResponsePage.aspx?id=z327fGQzzUGZdki7xIvYKsdYGVKci-RNlTl2T9pc_TpUNkhSRTNMMVNLUzBQOVVKMVdLWkFMWDZUMCQlQCN0PWcu">生徒入力用</a>
                                        <a class="btn btn-primary" role="button"
                                            href="https://kgefac.sharepoint.com/sites/msteams_777150/_layouts/15/Doc.aspx?sourcedoc={eb2f4f79-b5c1-409d-8899-b864d080762a}&action=embedview&AllowTyping=True&wdInConfigurator=True">教員確認用</a>
                                        <a class="btn btn-outline-primary" role="button"
                                            href="https://teams.microsoft.com/_#/school/files/Teams%E5%82%99%E5%BF%98%E9%8C%B2?threadId=19%3A78b74f6be33643508b25545be068ff8f%40thread.tacv2&ctx=channel&context=%25E5%2581%25A5%25E5%25BA%25B7%25E8%25A6%25B3%25E5%25AF%259F%25E3%2581%25BE%25E3%2581%25A8%25E3%2582%2581&rootfolder=%252Fsites%252Fmsteams_1d13d1%252FShared%2520Documents%252FTeams%25E5%2582%2599%25E5%25BF%2598%25E9%258C%25B2%252F%25E3%2582%25A2%25E3%2583%25B3%25E3%2582%25B1%25E3%2583%25BC%25E3%2583%2588%25E7%25AE%25A1%25E7%2590%2586%252F%25E5%2581%25A5%25E5%25BA%25B7%25E8%25A6%25B3%25E5%25AF%259F%25E3%2581%25BE%25E3%2581%25A8%25E3%2582%2581">月例レポート</a>
                                    </div>
                                </div>






                                <div class="alert alert-warning" role="alert">
                                    <h5>平日8時前の入力を呼び掛けてください！</h5>
                                    SHR直前に入力が集中すると、閲覧が困難になります。<br />
                                    8時前の入力を再度徹底させてください。
                                    <hr>
                                    データ書込みでファイルがビジー状態になることが原因です。<br />
                                    休日は時間が分散するので、その日の内に入力してくれればOKです。
                                </div>

                                <label class="btn btn-warning" for="教員確認用error">「教員確認用」が開けないとき</label>
                                <input type="checkbox" id="教員確認用error" class="chkbx_disptoggle" checked>
                                <div class="alert alert-warning" role="alert">
                                    <ol>
                                        <li>
                                            一度、<a href="https://kgefac.sharepoint.com/">『コチラ』</a>を開く。</br>
                                            （アクセス権を要求されますが、無視してください）
                                        </li>
                                        <li>前のウィンドウを閉じて、本来のページを開く。</br>
                                            ※本来のページがダメな場合は
                                            <a
                                                href="https://kgefac.sharepoint.com/:x:/r/sites/msteams_777150/_layouts/15/Doc.aspx?sourcedoc=%7Beb2f4f79-b5c1-409d-8899-b864d080762a%7D&action=embedview&AllowTyping=True&wdInConfigurator=True">「コチラ」</a>を試してください…
                                        </li>
                                    </ol>
                                </div>
                                <hr>
                                <h5 class="card-title">教職員健康観察</h5>
                                <p class="card-text">
                                <div class="text-center">
                                    <a class="btn btn-primary" role="button"
                                        href="https://forms.office.com/Pages/ResponsePage.aspx?id=z327fGQzzUGZdki7xIvYKpHVAnr2D4tFhVOJ99MGdnVURFozWkJTS0pLUlpLSU5GS1VHQVVUSVZSRCQlQCN0PWcu">教職員入力用</a>
                                </div>
                                </p>
                            </div>
                            <div class="card-footer">
                            </div>
                        </div>
                    </div>

                    <!-- COVID-19 widget -->
                    <div class="col-12 col-lg-6">
                        <div class="card">
                            <div class="card-header"><span class="material-icons">
                                    coronavirus
                                </span>COVID-19 Info</div>
                            <div class="card-body">
                                <div class="js-scrollable">
                                    <table class="table table-bordered border-secondary" id="COVID19infoTbl">
                                        <thead></thead>
                                        <tfoot></tfoot>
                                        <tbody></tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="card-footer">
                                <small class="text-muted">
                                    <a href="https://covid19japan.com/">Data Source</a>
                                </small>
                            </div>
                        </div>
                        <script>
                            function addCOVID19tbl(title, content) {
                                document.getElementById("COVID19infoTbl").children[2].innerHTML += "<tr><th>" +
                                    title + "</th><td class='text-center'>" + content + "</td></tr>";
                            }
                            $.getJSON("https://data.covid19japan.com/summary/latest.json", (data) => {
                                // 昨日基準で処理：今日のデータはまだない可能性がある
                                let yesterday = new Date();
                                yesterday = new Date(yesterday.getFullYear(), yesterday.getMonth(), yesterday.getDate() - 1);
                                let youbi = ("日,月,火,水,木,金,土").split(",");

                                // thead
                                document.getElementById("COVID19infoTbl").children[0].innerHTML += "" +
                                    "<tr><td colspan='2' class='text-center'>" +
                                    yesterday.getFullYear() + "/" +
                                    (yesterday.getMonth() + 1) + "/" +
                                    yesterday.getDate() + "(" + youbi[yesterday.getDay()] + ")の陽性者数" +
                                    "</td></tr>";

                                // tfoot
                                let tfootTx = data.updated;
                                tfootTx = tfootTx.replace("T", "(").replace("+09:00", "JST)");
                                document.getElementById("COVID19infoTbl").children[1].innerHTML += "" +
                                    "<tr><td colspan='2' class='text-right'>Update：" +
                                    tfootTx + "</td></tr>";
                                for (let key in data.prefectures[4]) {
                                    //addCOVID19tbl(key, data.prefectures[4][key]);
                                }


                                // 特定抽出市町村（表示名、検索文字列）・・・患者データの分析が必要かも
                                let city = [
                                    { "伊奈町": ["Ina"] },
                                    { "上尾市": ["Ageo"] },
                                    { "さいたま市": ["Saitama", "Saitama city", "Saitama City"] }
                                ];

                                // 都道府県別データ取得
                                let tbl = { "陽性者": { "埼玉県": 0, "東京都": 0, "全国": 0 } };
                                for (let pref in data.prefectures) {
                                    // 陽性者記録開始日取得
                                    let ConfirmedStartDate = data.prefectures[pref].dailyConfirmedStartDate.split("-");
                                    ConfirmedStartDate = new Date(Number(ConfirmedStartDate[0]),
                                        Number(ConfirmedStartDate[1]) - 1,
                                        Number(ConfirmedStartDate[2])
                                    );
                                    // 処理対象日のデータ配列番号取得
                                    let i = (yesterday.getTime() - ConfirmedStartDate.getTime()) / (1000 * 60 * 60 * 24);
                                    switch (data.prefectures[pref].name_ja) {
                                        case "埼玉県":
                                            tbl["陽性者"]["埼玉県"] = data.prefectures[pref].dailyConfirmedCount[i];
                                            break;
                                        case "東京都":
                                            tbl["陽性者"]["東京都"] = data.prefectures[pref].dailyConfirmedCount[i];
                                            break;
                                        default:
                                            break;
                                    }
                                    tbl["陽性者"]["全国"] += data.prefectures[pref].dailyConfirmedCount[i];
                                }
                                // table生成
                                addCOVID19tbl("埼玉県", tbl["陽性者"]["埼玉県"]);
                                addCOVID19tbl("東京都", tbl["陽性者"]["東京都"]);
                                addCOVID19tbl("全国", tbl["陽性者"]["全国"]);
                            });
                        </script>
                    </div>

                    <!-- イベント管理 -->
                    <div class="col-12 col-lg-6">
                        <div class="card">
                            <div class="card-header"><span class="material-icons">
                                    event_available
                                </span>受験生向けイベント</div>
                            <div class="card-body">
                                <h5 class="card-title">教職員向けフォーム</h5>
                                <h6 class="card-subtitle text-muted">個別相談・部活動体験等の登録・確認はコチラから</h6>
                                <p class="card-text">
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">
                                        まずはココから登録。<br />
                                        <small>登録の手間削減のため、紙ではなくWEB登録にご協力ください。</small><br />
                                        <a class="btn btn-outline-primary" role="button"
                                            href="https://forms.office.com/Pages/ResponsePage.aspx?id=z327fGQzzUGZdki7xIvYKpHVAnr2D4tFhVOJ99MGdnVUOE5EMUxNWlRDNDNRSVk4NVJTSjlPMVYxRyQlQCN0PWcu">イベント登録申請</a>
                                    </li>
                                    <li class="list-group-item">
                                        登録イベントの参加者一覧はコチラ。<br />
                                        <a class="btn btn-outline-primary" role="button"
                                            href="https://kgefac.sharepoint.com/sites/msteams_1d13d1/_layouts/15/Doc.aspx?OR=teams&action=edit&sourcedoc={44753E55-03A6-4562-8AAF-339B64CDEB75}">イベント申込状況確認</a>
                                    </li>
                                    <li class="list-group-item">
                                        個別相談の教員用フォームはコチラ。<br />
                                        <a class="btn btn-primary" role="button"
                                            href="https://kbs.kgef.ac.jp/seiseki/">個別相談入力フォーム</a>
                                    </li>
                                </ul>
                                <hr>
                                <h5 class="card-title">受験生向けフォーム</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">
                                        <a class="btn btn-outline-primary" role="button"
                                            href="https://hs.kgef.ac.jp/kobetsu/moushikomi/">イベント予約フォーム</a>
                                    </li>
                                </ul>
                                </p>
                            </div>
                            <div class="card-footer">
                                <small class="text-muted">
                                    <a
                                        href="https://teams.microsoft.com/_#/school/files/WEB%E3%82%B5%E3%82%A4%E3%83%88%E9%96%A2%E4%BF%82?threadId=19%3Af7977620b7234abf8ccc2a9972d71e3f%40thread.tacv2&ctx=channel&context=%25E4%25BA%2588%25E7%25B4%2584%25E3%2582%25B7%25E3%2582%25B9%25E3%2583%2586%25E3%2583%25A0v2020&rootfolder=%252Fsites%252Fmsteams_1d13d1%252FShared%2520Documents%252FWEB%25E3%2582%25B5%25E3%2582%25A4%25E3%2583%2588%25E9%2596%25A2%25E4%25BF%2582%252F%25E4%25BA%2588%25E7%25B4%2584%25E3%2582%25B7%25E3%2582%25B9%25E3%2583%2586%25E3%2583%25A0v2020">相談関連files</a>
                                    ／
                                    <a href="https://hs.kgef.ac.jp/kobetsu/mstmnt/">◆個別相談MST管理用</a>
                                </small>
                            </div>
                        </div>
                    </div>

                    <!-- 授業アンケート -->
                    <div class="col-12 col-lg-6 d-none">
                        <div class="card">
                            <div class="card-header"><span class="material-icons">
                                    list_alt
                                </span>授業アンケート</div>
                            <div class="card-body">
                                <a class="btn btn-info text-wrap" role="button"
                                    href="https://teams.microsoft.com/l/message/19:0938ec52fc9d45728405629b4428ef03@thread.tacv2/1605677343219?tenantId=7cbb7dcf-3364-41cd-9976-48bbc48bd82a&groupId=5df0b8bb-ffcc-4b00-95df-f3c501e1f37f&parentMessageId=1605677343219&teamName=%E6%95%99%E8%81%B7%E5%93%A1&channelName=%E4%B8%80%E8%88%AC&createdTime=1605677343219">アンケートを実施する授業の事前登録について</a>
                                <hr />
                                <h5 class="card-title">生徒入力フォーム</h5>
                                <h6 class="card-subtitle text-muted">すべての授業で共通のフォームを使用します</h6>
                                <p class="card-text text-center">
                                    <a class="btn btn-outline-primary disabled" role="button">入力フォーム（準備中）</a>
                                </p>
                                <hr>
                                <label class="btn btn-outline-primary" role="button" for="教員用サンプル">教員用サンプル</label>
                                <input type="checkbox" id="教員用サンプル" class="chkbx_disptoggle" checked>
                                <div>
                                    <h5 class="card-title">教員用サンプル</h5>
                                    <h6 class="card-subtitle text-muted">
                                        【使用するのか知りませんが、もしものためにデバッグにご協力ください】<br />本番は別URLになります</h6>
                                    <p class="card-text text-center">
                                        <a class="btn btn-primary" role="button"
                                            href="https://forms.office.com/Pages/ResponsePage.aspx?id=z327fGQzzUGZdki7xIvYKpHVAnr2D4tFhVOJ99MGdnVUQ0NXRFZJSkVRU1NENUFDVkxFVFRBWDBKTiQlQCN0PWcu">
                                            入力フォームサンプル
                                        </a>
                                    </p>
                                    <ul class="list-group">
                                        <li class="list-group-item list-group-item-warning">授業アンケート動作確認のお願い
                                            <div class="list-group">
                                                <div class="list-group-item list-group-item-info">
                                                    お手数をお掛けしますが、以下のチェックをお願いします。<br />
                                                    <small
                                                        class="text-muted">※チェックボックスは便宜上のもので、何か情報が送信されることはありません。</small>
                                                </div>
                                                <div class="list-group-item list-group-item-info">
                                                    確認で入力したものは、試しに「送信」まで行ってください。<br />
                                                    <small class="text-muted">※具体的なデータサンプルがないと、デバッグが難しいのです。</small>
                                                </div>
                                            </div>
                                            なお、本番のアンケートは担当者のみが閲覧できる状態にします。<br />
                                            システム担当も内容を見ることができないため、事前のデバッグ作業にご協力をお願いします。
                                        </li>
                                        <li class="list-group-item">担任の先生
                                            <div class="list-group">
                                                <label class="list-group-item list-group-item-info">
                                                    <input class="form-check-input mr-1" type="checkbox">
                                                    担任クラスの授業について、正しい項目があるか？
                                                </label><label class="list-group-item list-group-item-light">
                                                    (例) 「学年選択・HRの授業・授業担当者」が表示されるか？
                                                </label>
                                            </div>
                                        </li>
                                        <li class="list-group-item">授業担当の先生
                                            <div class="list-group">
                                                <label class="list-group-item list-group-item-info">
                                                    <input class="form-check-input mr-1" type="checkbox">
                                                    ご自身の担当授業について、正しい項目があるか？
                                                </label>
                                                <label class="list-group-item list-group-item-light">
                                                    (例) 「学年選択・担当授業・授業担当者」が表示されるか？
                                                </label>
                                                <label class="list-group-item list-group-item-light">
                                                    (例) クラスをまたぐ際、適切なグループが存在するか？<br />
                                                    <small
                                                        class="text-muted">これが無いと、「体育）帯展開なのにクラス別集計のみ」・「数学）αβなのにクラス内mix集計」などになり、集計が煩雑になってしまいます</small>
                                                </label>
                                            </div>
                                        </li>
                                    </ul>
                                    <p class="card-text">
                                        参考：<a class="btn btn-outline-primary" role="button"
                                            href="./data/授業アンケート.pdf">システム概要</a>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 健康観察Overview -->
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">健康観察Overview</div>

                            <div class="card-body">

                                <h5 class="card-title">全校概況</h5>
                                <div class="text-center">
                                    <iframe width="594" height="593" frameborder="0" scrolling="no"
                                        src="https://kgefac.sharepoint.com/sites/msteams_1d13d1/_layouts/15/Doc.aspx?sourcedoc={7ddd4ab2-f6e4-48de-bc81-b9069dae2ca7}&action=embedview&wdAllowInteractivity=False&AllowTyping=True&ActiveCell='%E7%B0%A1%E6%98%93%E6%97%A5%E5%A0%B1'!P2&Item=%E7%B0%A1%E6%98%93%E6%97%A5%E5%A0%B1!Print_Area&wdHideGridlines=True&wdInConfigurator=True"></iframe>
                                </div>
                                <hr>
                                <h5 class="card-title">クラス別一覧</h5>
                                <div class="text-center">
                                    <iframe width="800" height="900" frameborder="0" scrolling="no"
                                        src="https://kgefac.sharepoint.com/sites/msteams_1d13d1/_layouts/15/Doc.aspx?sourcedoc={7ddd4ab2-f6e4-48de-bc81-b9069dae2ca7}&action=embedview&wdAllowInteractivity=False&AllowTyping=True&ActiveCell='%E3%82%AF%E3%83%A9%E3%82%B9%E5%88%A5'!C11&Item=%E3%82%AF%E3%83%A9%E3%82%B9%E5%88%A5!Print_Area&wdHideGridlines=True&wdInConfigurator=True"></iframe>
                                </div>
                            </div>
                            <div class="card-footer">
                                <small class="text-muted">Teamsログイン状態でないと表示されません</small>
                            </div>
                        </div>
                    </div>

                    <!-- クラス別健康観察 -->
                    <div class="col-12 d-none">
                        <div class="card">
                            <div class="card-header" id="クラス別健康観察">旧 健康観察</div>
                            <h6 class="card-subtitle text-muted">2021.04.04まで（以降は新フォームに切替え）</h6>
                            <div class="card-body text-center">
                                <iframe style="width:100%;max-width:700px;height:350px;" frameborder="0" scrolling="no"
                                    src="https://kgefac.sharepoint.com/sites/msteams_777150/_layouts/15/Doc.aspx?sourcedoc={eb2f4f79-b5c1-409d-8899-b864d080762a}&action=embedview&AllowTyping=True&ActiveCell='%E7%B0%A1%E6%98%93%E6%97%A5%E5%A0%B1'!S2&Item=%E7%B0%A1%E6%98%93%E6%97%A5%E5%A0%B1!Print_Area&wdHideGridlines=True&wdInConfigurator=True"></iframe>
                                <iframe style="width:100%;height:900px;" frameborder="0" scrolling="no"
                                    src="https://kgefac.sharepoint.com/sites/msteams_777150/_layouts/15/Doc.aspx?sourcedoc={eb2f4f79-b5c1-409d-8899-b864d080762a}&action=embedview&AllowTyping=True&ActiveCell='%E3%82%AF%E3%83%A9%E3%82%B9%E5%88%A5'!H2&Item=%E3%82%AF%E3%83%A9%E3%82%B9%E5%88%A5!Print_Area&wdHideGridlines=True&wdInConfigurator=True"></iframe>
                            </div>
                        </div>
                    </div>

                    <!-- links -->
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header"><span class="material-icons">
                                    link
                                </span>Links</div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-lg-3 mb-2">
                                        <div class="list-group" id="list-tab" role="tablist">
                                            <a class="list-group-item list-group-item-action active"
                                                id="list-learning-list" data-toggle="list" href="#list-learning"
                                                role="tab" aria-controls="learning">学習・大学入試</a>
                                            <a class="list-group-item list-group-item-action" id="list-COVID-list"
                                                data-toggle="list" href="#list-COVID" role="tab"
                                                aria-controls="COVID">COVID-19</a>
                                            <a class="list-group-item list-group-item-action" id="list-Forms-list"
                                                data-toggle="list" href="#list-Forms" role="tab"
                                                aria-controls="profile">Forms</a>
                                        </div>
                                    </div>
                                    <div class="col-lg-9">
                                        <div class="tab-content" id="nav-tabContent">
                                            <div class="tab-pane fade active show" id="list-learning" role="tabpanel"
                                                aria-labelledby="list-learning-list">
                                                <p>
                                                    <a href="http://www.dnc.ac.jp/">独立行政法人 大学入試センター</a>
                                                </p>

                                                <div class="js-scrollable">
                                                    <table class="table table-bordered border-secondary">
                                                        <thead>
                                                            <tr>
                                                                <th>事業者</th>
                                                                <th>模試</th>
                                                                <th>進学情報・過去問</th>
                                                                <th>教員用</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <th><a href="http://www.benesse.co.jp/"
                                                                        target="_blank">Benesse</a></th>
                                                                <td><a href="http://manabi.benesse.ne.jp/assess/moshi/"
                                                                        target="_blank">進研模試</a><br>
                                                                    <a href="http://manabi.benesse.ne.jp/assess/ss/"
                                                                        target="_blank">スタディーサポート</a><br>
                                                                    <a href="http://gtec.for-students.jp/"
                                                                        target="_blank">GTEC
                                                                        for
                                                                        STUDENTS</a>
                                                                </td>
                                                                <td><a href="https://manabi.benesse.ne.jp/wi/jsp/gy1_toroku/login_failure_digi.jsp"
                                                                        target="_blank">進研模試デジタルサービス</a><br>
                                                                    <a href="http://manabi.benesse.ne.jp/"
                                                                        target="_blank">マナビジョン</a><br>
                                                                    <a href="http://manabi.benesse.ne.jp/nyushi/kakomon/"
                                                                        target="_blank">大学入試過去問ダウンロードサービス</a>
                                                                </td>
                                                                <td><a href="http://bhso.benesse.ne.jp/"
                                                                        target="_blank">Benesse
                                                                        High School
                                                                        Online</a></td>
                                                            </tr>
                                                            <tr>
                                                                <th><a href="http://www.yozemi.ac.jp"
                                                                        target="_blank">代々木ゼミナール</a></th>
                                                                <td><a href="http://www.yozemi.ac.jp/test/index.html"
                                                                        target="_blank">代ゼミ模試</a>
                                                                </td>
                                                                <td></td>
                                                                <td></td>
                                                            </tr>
                                                            <tr>
                                                                <th><a href="http://www.kawai-juku.ac.jp/"
                                                                        target="_blank">河合塾</a></th>
                                                                <td><a href="http://www.kawai-juku.ac.jp/trial-exam/zento/"
                                                                        target="_blank">全統模試</a>
                                                                </td>
                                                                <td><a href="http://www.keinet.ne.jp/"
                                                                        target="_blank">Kei-Net</a></td>
                                                                <td></td>
                                                            </tr>
                                                            <tr>
                                                                <th><a href="http://www2.sundai.ac.jp/yobi/sv/index.html"
                                                                        target="_blank">駿台予備校</a>
                                                                </th>
                                                                <td><a href="http://www2.sundai.ac.jp/yobi/sv/moshi/index.html"
                                                                        target="_blank">駿台模試</a>
                                                                </td>
                                                                <td><a href="http://www2.sundai.ac.jp/yobi/sv/news/index.html"
                                                                        target="_blank">大学入試情報</a>
                                                                </td>
                                                                <td></td>
                                                            </tr>
                                                            <tr>
                                                                <th><a href="http://www.toshin.com/"
                                                                        target="_blank">東進ハイスクール</a></th>
                                                                <td><a href="http://www.toshin.com/hs/event/exam/"
                                                                        target="_blank">東進模試</a><br>
                                                                    <a href="http://www.toitsutest.com/"
                                                                        target="_blank">全国統一テスト</a>
                                                                </td>
                                                                <td><a href="http://www.toshin.com/nyushi/index_niji.php"
                                                                        target="_blank">大学入試問題
                                                                        過去問データベース</a><br>
                                                                    <a href="http://www.toshin.com/univ/"
                                                                        target="_blank">大学案内</a>
                                                                </td>
                                                                <td></td>
                                                            </tr>
                                                            <tr>
                                                                <th>リクルート</th>
                                                                <td></td>
                                                                <td><a href="https://studysapuri.jp/"
                                                                        target="_blank">スタディサプリ</a></td>
                                                                <td><a href="https://link.studysapuri.jp/ja/login"
                                                                        target="_blank">スタディサプリ
                                                                        for Teachers</a></td>
                                                            </tr>
                                                            <tr style="display:none">
                                                                <th><a href="http://www.zkai.co.jp/"
                                                                        target="_blank">Z会</a></th>
                                                                <td>会員のみ申込可。<br>
                                                                    ただし、河合塾共催なので<br>
                                                                    事実上会員外も申込可</td>
                                                                <td></td>
                                                                <td></td>
                                                            </tr>
                                                            <tr>
                                                                <th>その他</th>
                                                                <td></td>
                                                                <td>
                                                                    <a href="http://www.cybercollege.jp/"
                                                                        target="_blank">サイバーカレッジ</a><br>
                                                                    <a href="http://passnavi.evidus.com/"
                                                                        target="_blank">大学受験パスナビ：旺文社</a>
                                                                </td>
                                                                <td></td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <script>
                                                    new ScrollHint('.js-scrollable');
                                                </script>

                                            </div>
                                            <div class="tab-pane fade" id="list-COVID" role="tabpanel"
                                                aria-labelledby="list-COVID-list">
                                                <div id="COVIDlinks" class="row g-2"></div>
                                                <script>
                                                    let ele = document.getElementById("COVIDlinks");
                                                    let data = [
                                                        {
                                                            "name": "WHO公式",
                                                            "href": "https://extranet.who.int/kobe_centre/ja/covid"
                                                        },
                                                        {
                                                            "name": "内閣官房",
                                                            "href": "https://corona.go.jp/"
                                                        },
                                                        {
                                                            "name": "厚生労働省",
                                                            "href": "https://www.mhlw.go.jp/stf/seisakunitsuite/bunya/0000164708_00001.html"
                                                        },
                                                        {
                                                            "name": "厚生労働省COCOA",
                                                            "href": "https://www.mhlw.go.jp/stf/seisakunitsuite/bunya/cocoa_00138.html"
                                                        },
                                                        {
                                                            "name": "国立感染症研究所",
                                                            "href": "https://www.niid.go.jp/niid/ja/diseases/ka/corona-virus/2019-ncov.html"
                                                        },
                                                        {
                                                            "name": "東京都",
                                                            "href": "https://stopcovid19.metro.tokyo.lg.jp/"
                                                        },
                                                        {
                                                            "name": "埼玉県",
                                                            "href": "https://www.pref.saitama.lg.jp/a0301/covid19_sougousite.html"
                                                        },
                                                        {
                                                            "name": "埼玉県(非公式)",
                                                            "href": "https://saitama.stopcovid19.jp/"
                                                        },
                                                        {
                                                            "name": "伊奈町",
                                                            "href": "https://www.town.saitama-ina.lg.jp/category/15-8-8-0-0.html"
                                                        },
                                                        {
                                                            "name": "上尾市",
                                                            "href": "https://www.city.ageo.lg.jp/page/coronavirus.html"
                                                        },
                                                        {
                                                            "name": "さいたま市",
                                                            "href": "https://www.city.saitama.jp/002/001/008/006/index.html"
                                                        },
                                                        {
                                                            "name": "Google",
                                                            "href": "https://datastudio.google.com/reporting/8224d512-a76e-4d38-91c1-935ba119eb8f/page/ncZpB?s=nXbF2P6La2M"
                                                        },
                                                        {
                                                            "name": "NHK",
                                                            "href": "https://www3.nhk.or.jp/news/special/coronavirus/"
                                                        },
                                                        {
                                                            "name": "Japan Tracker",
                                                            "href": "https://covid19japan.com/"
                                                        },
                                                        {
                                                            "name": "東洋経済",
                                                            "href": "https://toyokeizai.net/sp/visual/tko/covid19/"
                                                        },
                                                        {
                                                            "name": "J.A.G JAPAN",
                                                            "href": "https://gis.jag-japan.com/covid19jp/"
                                                        },
                                                        {
                                                            "name": "Johns Hopkins Univ.",
                                                            "href": "https://gisanddata.maps.arcgis.com/apps/opsdashboard/index.html#/bda7594740fd40299423467b48e9ecf6"
                                                        },
                                                        {
                                                            "name": "splunk hub",
                                                            "href": "https://covid-19.splunkforgood.com/hub"
                                                        }
                                                    ];
                                                    for (let i = 0; i < data.length; i++) {
                                                        let a = document.createElement("a");
                                                        a.classList.add("text-center", "col-12", "col-sm-6", "col-lg-4");
                                                        a.href = data[i].href;
                                                        a.appendChild(
                                                            document.createTextNode(data[i].name)
                                                        );
                                                        ele.appendChild(a);
                                                    }
                                                </script>
                                            </div>
                                            <div class="tab-pane fade" id="list-Forms" role="tabpanel"
                                                aria-labelledby="list-Forms-list">
                                                <p>過去のアンケート類ストックです。</p>
                                                <dl class="row">
                                                    <dt class="col-sm-3">出欠確認</dt>
                                                    <dd class="col-sm-9">
                                                        <a class="btn btn-primary" role="button"
                                                            href="https://forms.office.com/Pages/ResponsePage.aspx?id=z327fGQzzUGZdki7xIvYKrrQV_Ds3nlPm9dRr6u4IARUMFVPUlhEWk04MFFBVVkxVEUwVEIxTExZRSQlQCN0PWcu">生徒入力用</a>
                                                        <a class="btn btn-primary" role="button"
                                                            href="https://kgefac.sharepoint.com/sites/ICT/_layouts/15/Doc.aspx?sourcedoc=%7b3832abaf-a986-4da4-bfc1-f8ce30afcb6a%7d&action=embedview&wdAllowInteractivity=False&AllowTyping=True&wdInConfigurator=True">教員確認用</a>
                                                    </dd>
                                                </dl>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-footer">
                                <small class="text-muted"></small>
                            </div>
                        </div>
                    </div>

                </div><!-- row -->

            </section>

            <section class="col-12 col-xl-2">

                <div class="row g-2">

                    <!-- 授業タイマー -->
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header"><span class="material-icons">
                                    alarm_on
                                </span>Timer</div>
                            <div class="card-body">
                                <div class="card-text">
                                    <div id="授業タイマー見出し"></div>
                                    <div class="progress">
                                        <div id="授業タイマー"
                                            class="progress-bar progress-bar-striped bg-success progress-bar-animated"
                                            role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0"
                                            aria-valuemax="100">
                                        </div>
                                    </div>
                                    <small class="text-muted" onclick="getTimeList()">(2021年4月～)50分授業版</small>
                                </div>
                                <script>
                                    // 項目名,h,m
                                    //  平常
                                    let timetbl = [
                                        ["-", 0, 0],
                                        ["SHR", 8, 40],
                                        ["1限", 8, 55],
                                        ["1限終わり", 9, 45],
                                        ["2限", 9, 55],
                                        ["2限終わり", 10, 45],
                                        ["3限", 10, 55],
                                        ["3限終わり", 11, 45],
                                        ["4限", 11, 55],
                                        ["4限終わり", 12, 45],
                                        ["5限", 13, 30],
                                        ["5限終わり", 14, 20],
                                        ["6限", 14, 30],
                                        ["6限終わり", 15, 20],
                                        ["7限", 15, 30],
                                        ["7限終わり", 16, 20],
                                        ["完全下校", 19, 00],
                                        ["閉門", 20, 00]
                                    ];
                                    
                                    /* 40分短縮（2020/01/08～）
                                    let timetbl = [
                                        ["--", 0, 0],
                                        ["SHR", 8, 45],
                                        ["1限開始", 9, 00],
                                        ["1限終わり", 9, 40],
                                        ["2限開始", 9, 50],
                                        ["2限終わり", 10, 30],
                                        ["3限開始", 10, 40],
                                        ["3限終わり", 11, 20],
                                        ["4限開始", 11, 30],
                                        ["4限終わり", 12, 10],
                                        ["5限開始", 13, 00],
                                        ["5限終わり", 13, 40],
                                        ["6限開始", 13, 50],
                                        ["6限終わり", 14, 30],
                                        ["7限開始", 14, 40],
                                        ["7限終わり", 15, 20],
                                        ["完全下校", 17, 00],
                                        ["閉門", 20, 00]
                                    ];
                                    */
                                    setInterval(function () {
                                        let now = new Date();
                                        let time = new Date();
                                        let time0;
                                        for (let i = 0; i < timetbl.length; i++) {
                                            time.setHours(timetbl[i][1], timetbl[i][2], 0, 0);
                                            if (now > time) {
                                                time0 = new Date(time);
                                                if (i == timetbl.length - 1) {
                                                    document.getElementById("授業タイマー見出し").innerHTML = "";
                                                    document.getElementById("授業タイマー").setAttribute("style", "width:0;");
                                                    document.getElementById("授業タイマー").setAttribute("aria-valuenow", "0");
                                                    break;
                                                }
                                                continue;
                                            } else {
                                                document.getElementById("授業タイマー見出し").innerHTML = timetbl[i][0] +
                                                    "(" + timetbl[i][1] + ":" + ('0' + timetbl[i][2]).slice(-2) + ")まで、あと" +
                                                    Math.floor((time.getTime() - now.getTime()) / 1000 / 60) + "分";
                                                let p = (now.getTime() - time0.getTime()) / (time.getTime() - time0.getTime()) * 100;
                                                document.getElementById("授業タイマー").setAttribute("style", "width:" + p + "%;");
                                                document.getElementById("授業タイマー").setAttribute("aria-valuenow", p);
                                                break;
                                            }
                                        }
                                    }, 1000);

                                    function getTimeList() {
                                        let tx = "";
                                        for (let i = 0; i < timetbl.length; i++) {
                                            tx += timetbl[i][0] + "　" + timetbl[i][1] + ":" + ('0' + timetbl[i][2]).slice(-2) + "\n";
                                        }
                                        alert(tx);
                                    }
                                </script>

                                <div class="card-text" id="XMLSampleRequest"></div>
                                <script>
                                    /*
                                    $(document).ready(function () {
                                        $.ajax({
                                            type: "get",
                                            url: "https://jsh.kgef.ac.jp/feed/"
                                        }).done(function (result) {
                                            $(result).find("sample").each(function () {
                                                $("#XMLSampleRequest").append('<h3>' + $(this).find('title').text() + '</h3>' + '<p>' + $(this).find('link').text() + '</p>');
                                            });
                                            console.log(result);
                                        });
                                    });
                                    */
                                </script>
                            </div>
                            <div class="card-footer">
                                <small class="text-muted">(注) 常に平日基準で表示</small>
                            </div>
                        </div>
                    </div>

                    <!-- スクールバス -->
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header"><span class="material-icons">
                                    departure_board
                                </span>School Bus</div>
                            <div class="card-body">
                                <div class="card-text">
                                    <table id="schoolBusTbl"></table>
                                    <style>
                                        #schoolBusTbl {
                                            margin: auto;
                                        }

                                        #schoolBusTbl th {
                                            border: 1px solid #000;
                                        }

                                        #schoolBusTbl * {
                                            text-align: center;
                                        }
                                    </style>
                                    <hr>
                                    <small
                                        class="text-muted">2月から（本来の学校サイト上の）スクールバス時刻表データ更新方法を変更したため、こちらでも引用できるようになりました。
                                        IEや古いスマホなど、特定の環境で閲覧できない場合や、何かお困り・お気付きの際はご連絡ください。</small>
                                </div>
                                <script>
                                    function setBusRow(tbody, th_tx, td_tx = null) {
                                        let tr0 = document.createElement("tr");
                                        let th = document.createElement("th");
                                        th.innerText = th_tx;
                                        tr0.appendChild(th);
                                        tbody.appendChild(tr0);
                                        if (td_tx != null) {
                                            let tr1 = document.createElement("tr");
                                            let td = document.createElement("td");
                                            td.innerText = td_tx;
                                            tr1.appendChild(td);
                                            tbody.appendChild(tr1);
                                        }
                                    }
                                    function fixBusTime(time) {
                                        for (let i = 1; i < time.length; i++) {
                                            for (let j in time[i]) {
                                                if (time[i][j] == "〃") {
                                                    time[i][j] = time[i - 1][j];
                                                }
                                            }
                                        }
                                        return time;
                                    }
                                    $.ajax({
                                        "type": "GET", "async": true,
                                        "url": "https://script.google.com/macros/s/AKfycbygYn92oqaOVmzjdtv9Tug4jGebaOq9oYW6mKIM2Foiasqbd_hTJdVnuw/exec"
                                        // exec or dev
                                    }).then(
                                        // 通信success
                                        data => {
                                            console.log("Ajax通信success");
                                            console.log(data);
                                            let timeTbl = data.time;
                                            timeTbl = fixBusTime(timeTbl);
                                            // let passTbl = data.pass;
                                            // 時刻表処理
                                            let tbl = document.getElementById("schoolBusTbl");
                                            tbl.innerHTML = ""; // 初期化
                                            let tbody = document.createElement("tbody");
                                            // 今日の日付行取得
                                            let d = 0;
                                            let today = new Date();
                                            for (; d < timeTbl.length; d++) {
                                                if (timeTbl[d].month == (today.getMonth() + 1) &&
                                                    timeTbl[d].day == today.getDate()) {
                                                    setBusRow(tbody, timeTbl[d].month + "月" + timeTbl[d].day + "日(" + timeTbl[d].yobi + ")", timeTbl[d].remark);
                                                    setBusRow(tbody, timeTbl[0].ageo0, timeTbl[d].ageo0);
                                                    setBusRow(tbody, timeTbl[0].hasuda0, timeTbl[d].hasuda0);
                                                    setBusRow(tbody, timeTbl[0].ageo1, timeTbl[d].ageo1);
                                                    setBusRow(tbody, timeTbl[0].hasuda1, timeTbl[d].hasuda1);
                                                    break;
                                                }
                                            }
                                            tbl.appendChild(tbody);
                                        },
                                        // 通信error
                                        error => {
                                            console.log("Ajax通信error");
                                            console.log(error);
                                        }
                                    );
                                </script>
                            </div>
                            <div class="card-footer">
                                <small class="text-muted">
                                    <a href="https://jsh.kgef.ac.jp/schoolbus/">運行予定表</a>
                                </small>
                            </div>
                        </div>
                    </div>

                    <!-- 鉄道遅延 -->
                    <div class="card">
                        <div class="card-header"><span class="material-icons">
                                train
                            </span>Train Info</div>
                        <div class="card-body">
                            <div class="js-scrollable">
                                <table class="table table-bordered border-secondary" id="TrainInfo">
                                    <thead>
                                        <tr class="text-center">
                                            <th>路線種</th>
                                            <th>遅延路線</th>
                                        </tr>
                                    </thead>
                                    <tfoot>
                                        <tr>
                                            <td colspan="2" class="text-right"></td>
                                        </tr>
                                    </tfoot>
                                    <tbody></tbody>
                                </table>
                            </div>
                            <!--  trigger modal -->
                            <p>
                                <a role="button" class="btn btn-outline-primary" data-toggle="modal"
                                    data-target="#TrainModal">その他</a>
                            </p>
                            <!-- Modal -->
                            <div class="modal fade" id="TrainModal" tabindex="-1" aria-labelledby="TrainModalLabel"
                                aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="TrainModalLabel">遅延情報</h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body" id="TrainModalText">
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-primary"
                                                data-dismiss="modal">Close</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <script>
                            let trainList = [
                                { name: "ニューシャトル", line: ["ニューシャトル"] },
                                { name: "最寄りJR線<br/>(高/宇/SS/UT)", line: ("宇都宮,高崎,湘南新宿,上野東京").split(",") },
                                { name: "近隣JR<br/>(京浜,埼京,川越)", line: ("京浜東北,埼京,川越").split(",") },
                                { name: "東武線<br/>(STL/UPL)", line: ("アーバンパーク,スカイツリー,野田,伊勢崎線").split(",") }
                            ];
                            let tbody = document.getElementById("TrainInfo");
                            $.getJSON("https://tetsudo.rti-giken.jp/free/delay.json", (data) => {
                                let tbody = document.getElementById("TrainInfo").children[2];
                                for (let i = 0; i < trainList.length; i++) {
                                    let html = "<tr><th>" + trainList[i].name + "</th><td>";
                                    let delayFlag = false;
                                    for (let j = 0; j < trainList[i].line.length; j++) {
                                        for (let k in data) {
                                            if (data[k]["name"].indexOf(trainList[i].line[j]) > -1) {
                                                html += (delayFlag ? "<br/>" : "") + data[k].name;
                                                delayFlag = true;
                                            }
                                        }
                                    }
                                    tbody.innerHTML += html + (delayFlag ? "" : "-") + "</td></tr>";
                                }
                                // 全運行情報（UNIXタイム＝1970/1/1からの秒数なので注意）
                                let update = 0;
                                for (let k in data) {
                                    document.getElementById("TrainModalText").innerHTML += data[k].name + "／" + data[k].company +
                                        " (" + (new Date(data[k].lastupdate_gmt * 1000)).toLocaleTimeString() + ")<br/>";
                                    update = (update < data[k].lastupdate_gmt ? data[k].lastupdate_gmt : update);
                                }
                                update = new Date(update * 1000);
                                document.getElementById("TrainInfo").children[1].children[0].children[0].innerHTML = "Update：" +
                                    update.getFullYear() + "/" +
                                    (update.getMonth() + 1) + "/" +
                                    update.getDate() + " " +
                                    update.getHours() + ":" +
                                    update.getMinutes();
                            })
                        </script>
                        <div class="card-footer">
                            <small class="text-muted">
                                <a href="https://www.tetsudo.com/traffic/">鉄道com(運行情報まとめ)</a>
                                /
                                <a href="https://rti-giken.jp/fhc/api/train_tetsudo/">API</a>
                            </small>
                        </div>
                    </div>

                    <!-- お天気widget -->
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header"><span class="material-icons">
                                    wb_sunny
                                </span>Weather</div>
                            <div class="card-body">
                                <div class="card-text" id="WeatherForecast1"></div>
                                <div class="text-right">
                                    <!--  trigger modal -->
                                    <a role="button" class="btn btn-outline-primary" data-toggle="modal"
                                        data-target="#WeatherForecastDetail">Detail</a>
                                </div>
                            </div>
                            <div class="row g-0 m-2" id="WeatherForecast2"></div>
                            <div class="card-footer">
                                <small class="text-muted">
                                    <a href="https://www.jma.go.jp/jma/">気象庁</a>
                                    /
                                    <a href="https://weather.tsukumijima.net/">API</a>
                                </small>
                            </div>
                        </div>
                        <!-- Modal -->
                        <div class="modal fade" id="WeatherForecastDetail" tabindex="-1"
                            aria-labelledby="WeatherForecastDetailLabel" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="WeatherForecastDetailLabel">天気予報の詳細</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">詳細文</div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-primary"
                                            data-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <script>
                            // API from https://weather.tsukumijima.net/
                            $.getJSON("https://weather.tsukumijima.net/api/forecast/city/110010", (data) => {
                                //sample
                                // console.log(`id=${data.id}, name=${data.name}, email=${data.email}`);

                                // 詳細モーダル設定
                                let m = document.getElementById("WeatherForecastDetail");
                                m.children[0].children[0].children[0].children[0].innerHTML = data.title;
                                m.children[0].children[0].children[1].innerText = data.description.text +
                                    "\n\n気象庁予報発表日時：" + data.description.publicTime_format;
                                m.children[0].children[0].children[1].innerHTML += "<p class='text-right'>" +
                                    '<a href="' + data.link + '">[気象庁詳細ページ]</a>'
                                    + "</p>";

                                // 3日間予報
                                let weekday = ("日,月,火,水,木,金,土").split(",");


                                document.getElementById("WeatherForecast1").innerHTML = data.location.area + " " +
                                    data.location.prefecture + " " +
                                    data.location.city + "<br>" +
                                    data.publicTime_format + "発表";

                                for (let i = 0; i < 3; i++) {
                                    // 表示日の日付処理
                                    let date = data.forecasts[i].date.split("-");
                                    date = new Date(date[0], date[1] - 1, date[2]);
                                    // 表示設定
                                    document.getElementById("WeatherForecast2").innerHTML += "" +
                                        (i == 0 ? '<div class="col-12 col-md-4 col-xl-12">' :
                                            '<div class="col-12 col-sm-6 col-md-4 col-xl-12">') +
                                        '<div class="card h-100">' +
                                        '<div class="card-header text-center">' +
                                        data.forecasts[i].dateLabel +
                                        " " + date.getDate() + '日(' + weekday[date.getDay()] + ')' +
                                        '</div>' +
                                        '<div class="card-body">' +
                                        '<div class="row mb-2">' +
                                        (i == 0 ?
                                            '<div class="text-center align-self-center" style="width:' + data.forecasts[i].image.width + 'px;">' :
                                            '<div class="col-12 text-center align-self-center">'
                                        ) +
                                        '<img src="' + data.forecasts[i].image.url + '"' +
                                        'width="' + data.forecasts[i].image.width + '" ' +
                                        'height="' + data.forecasts[i].image.height + '" />' +
                                        '</div>' +
                                        '<div class="col text-center align-self-center">' +
                                        (data.forecasts[i].telop == null ? "未配信" : data.forecasts[i].telop) +
                                        // 明後日の最低・最高気温は取得できない
                                        (data.forecasts[i].temperature.max == null ? "" :
                                            '<br/>' + data.forecasts[i].temperature.max.celsius +
                                            // 今日の最低気温は取得できない
                                            (data.forecasts[i].temperature.min == null ? "" : "／" + data.forecasts[i].temperature.min.celsius) +
                                            '℃') +
                                        '</div>' +
                                        '</div>' +
                                        // 明後日の降水確率は取得できない
                                        (i == 2 ? "" :
                                            '<ul class="list-group card-text">' +
                                            '<li class="list-group-item text-center">降水確率</li>' +
                                            '<li class="list-group-item d-flex justify-content-between">' +
                                            '<span>00-06</span>' +
                                            '<span>' + data.forecasts[i].chanceOfRain["00-06"] + '</span>' +
                                            '</li>' +
                                            '<li class="list-group-item d-flex justify-content-between">' +
                                            '<span>06-12</span>' +
                                            '<span>' + data.forecasts[i].chanceOfRain["06-12"] + '</span>' +
                                            '</li>' +
                                            '<li class="list-group-item d-flex justify-content-between">' +
                                            '<span>12-18</span>' +
                                            '<span>' + data.forecasts[i].chanceOfRain["12-18"] + '</span>' +
                                            '</li>' +
                                            '<li class="list-group-item d-flex justify-content-between">' +
                                            '<span>18-24</span>' +
                                            '<span>' + data.forecasts[i].chanceOfRain["18-24"] + '</span>' +
                                            '</li>' +
                                            '</ul>') +
                                        '</div>' +
                                        '</div>' +
                                        '</div>';
                                }
                            });
                        </script>
                    </div>

                    <!-- debug -->
                    <div class="col-12 d-none">
                        <div class="card text-white bg-dark">
                            <div class="card-header">debug</div>
                            <div class="card-body">
                                <div class="card-text">
                                </div>
                                <div class="card-text" id="debugJson"></div>
                                <script>
                                    $.getJSON("https://zacky.ninja-x.jp/db/test.json", (data) => {
                                        console.log(data)
                                    });
                                </script>
                            </div>
                            <div class="card-footer">
                                <small class="text-muted">特に何がある訳でもありません。<br />調整用のエリアです…</small>
                            </div>
                        </div>
                    </div>
                </div>

            </section>
        </div>
        <div class="row mt-2 g-2">

            <!-- template -->
            <div class="col-12 col-lg-6 d-none">
                <div class="card">
                    <div class="card-header"></div>
                    <div class="card-body">
                        <div class="card-text">
                            <script
                                src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.js"></script>
                            <canvas id="coronaChart"></canvas>
                            <script>
                                let ctx = document.getElementById("coronaChart");
                                let myChart = new Chart(ctx, {
                                    type: "line",
                                    data: {
                                        labels: ["1", "1", "1", "1", "1", "1"],
                                        datasets: [
                                            {
                                                label: "東京都",
                                                data: [5, 6, 4, 3, 8, 5]
                                            },
                                            {
                                                label: "埼玉県",
                                                data: [4, 3, 5, 6, 8, 5]
                                            }
                                        ]
                                    },
                                    opitons: {
                                        title: {
                                            display: true,
                                            text: "COVID-19国内の状況"
                                        },
                                        scales: {
                                            yAxes: [{
                                                ticks: {
                                                    suggestedMax: 40,
                                                    suggestedMin: 0,
                                                    stepSize: 10
                                                }
                                            }]
                                        }
                                    }
                                });
                            </script>
                        </div>
                    </div>
                    <div class="card-footer">
                        <small class="text-muted">
                        </small>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <nav class="navbar navbar-dark bg-dark text-white" style="margin-top: 95vh;">
        <div class="container-fluid">
            <div class="jq_accordion">
                <span><span class="material-icons">
                        settings
                    </span>Setting</span>
                <div class="row">
                    <div class="col-12">
                        <div class="card bg-dark h-100">
                            <div class="card-header">Wallpaper</div>
                            <div class="card-body">
                                <script type="module">
                                    import Cookie from './script/js.cookie.min.js';
                                    // id,カテゴリ,分類,タイトル,著作権者,url
                                    // 見出し項目は、id=false を設定
                                    let bg = [
                                        [false, "◆都道府県の風景"],
                                        ["id", "find47", "北海道", "夕べの運河…", "Charlie_or_Y-N", "5AbuL"],
                                        ["id", "find47", "青森県", "奥入瀬渓流", "SQZ", "B3vNk"],
                                        ["id", "find47", "岩手県", "めがね橋を走るSL銀河ナイトクルーズ", "SQZ", "2HOIJ"],
                                        ["id", "find47", "宮城県", "気仙沼港 内湾", "平田 智幸", "gBvVl"],
                                        ["id", "find47", "秋田県", "秋田　田沢湖畔", "T-KIMURA", "lFNN0"],
                                        ["id", "find47", "山形県", "銀山温泉", "Koichi_Hayakawa", "WcMzR"],
                                        ["id", "find47", "福島県", "毘沙門沼（五色沼湖沼群）の秋", "Koichi_Hayakawa", "XAl8I"],
                                        ["id", "find47", "茨城県", "ひたち海浜公園　ネモフィラと菜の花畑", "SQZ", "Ph1XF"],
                                        ["id", "find47", "栃木県", "華厳の滝", "taka14", "cGhsA"],
                                        ["id", "find47", "群馬県", "一ノ倉沢　モルゲンロート", "iwashi", "w50bl"],
                                        ["id", "find47", "埼玉県", "川越祭り", "MitsunoriEgawa", "pNzeU"],
                                        ["id", "find47", "千葉県", "春のいすみ鉄道", "Akiko_Kubosawa", "K1oB0"],
                                        ["id", "find47", "東京都", "東京タワー", "tunafish", "WM44j"],
                                        ["id", "find47", "神奈川県", "湘南の朝活", "Makoto_Lab", "CKK7d"],
                                        ["id", "find47", "新潟県", "新潟市街地と佐渡島の夕景", "Koichi_Hayakawa", "w4KRg"],
                                        ["id", "find47", "富山県", "冬の立山より", "1sFp8", "1sFp8"],
                                        ["id", "find47", "石川県", "金沢市 兼六園夜景", "char", "MSwaP"],
                                        ["id", "find47", "福井県", "東尋坊", "SHori", "CO4Nv"],
                                        ["id", "find47", "山梨県", "日暮れの光景(富士山と河口湖)", "Koichi_Hayakawa", "3Zn46"],
                                        ["id", "find47", "長野県", "白糸の滝", "MitsunoriEgawa", "PwPYc"],
                                        ["id", "find47", "岐阜県", "モネの池", "SHori", "Y18Xw"],
                                        ["id", "find47", "静岡県", "修善寺温泉街", "伊豆市", "4Rb4E"],
                                        ["id", "find47", "愛知県", "９尺藤", "江南市", "sFLH2"],
                                        ["id", "find47", "三重県", "照らし出される", "Kenichi_Inagaki", "InPit"],
                                        ["id", "find47", "滋賀県", "彦根城", "tanaka", "qCDAx"],
                                        ["id", "find47", "京都府", "瑠璃光院", "Suganu0405", "LeA39"],
                                        ["id", "find47", "大阪府", "桜と天守閣…", "Charlie_or_Y-N", "5N8g8"],
                                        ["id", "find47", "兵庫県", "朝来市　竹田城跡　天空の城", "rikky_photography", "CAXbA"],
                                        ["id", "find47", "奈良県", "奈良公園", "SHori", "VhMAU"],
                                        ["id", "find47", "和歌山県", "有田みかんの山", "有田市", "aHs1x"],
                                        ["id", "find47", "鳥取県", "鳥取砂丘　雨上がりの朝", "rikky_photography", "xMEQL"],
                                        ["id", "find47", "島根県", "宍道湖 湖畔での夕景", "yogiyogi", "OqRSn"],
                                        ["id", "find47", "岡山県", "倉敷美観地区の夜景", "Yudai_photography", "s8i1I"],
                                        ["id", "find47", "広島県", "雪の広島城", "Tomato_249", "t9XMo"],
                                        ["id", "find47", "山口県", "錦帯橋", "tanaka", "vv7FQ"],
                                        ["id", "find47", "徳島県", "鳴門海峡の渦潮", "panpanzupan", "JQkmW"],
                                        ["id", "find47", "香川県", "金刀比羅宮", "日本観光振興協会", "Y7I3H"],
                                        ["id", "find47", "愛媛県", "亀老山から望む来島海峡大橋", "今治地方観光協会", "MOHWD"],
                                        ["id", "find47", "高知県", "朝霧の沈下橋", "K_Oda", "5AGSW"],
                                        ["id", "find47", "福岡県", "福岡の夜景", "Yudai_photography", "JSwdQ"],
                                        ["id", "find47", "佐賀県", "浜野浦の棚田", "TsuruSho7", "yZwz5"],
                                        ["id", "find47", "長崎県", "雲仙温泉", "長崎県", "kfJJN"],
                                        ["id", "find47", "熊本県", "市電のある風景", "Kohji_Asakawa", "ux6ZV"],
                                        ["id", "find47", "大分県", "別府の湯けむり", "別府市", "Vr5ws"],
                                        ["id", "find47", "宮崎県", "高千穂の秋", "Shiro_KUROGI", "6fW6E"],
                                        ["id", "find47", "鹿児島県", "佐多岬", "鹿児島県", "CfTFK"],
                                        ["id", "find47", "沖縄県", "平久保崎", "石垣市", "cQQMQ"],
                                        /*
                                        [false, "◆スタジオジブリコレクション"],
                                        ["id", "ジブリ", "思い出のマーニー", "船の上で", "© 2014 Studio Ghibli・NDHDMTK", "http://www.ghibli.jp/gallery/marnie021.jpg"],
                                        ["id", "ジブリ", "風立ちぬ", "飛行機", "© 2013 Studio Ghibli・NDHDMTK", "http://www.ghibli.jp/gallery/kazetachinu044.jpg"],
                                        ["id", "ジブリ", "コクリコ坂から", "カルチェラタン", "© 2011 高橋千鶴・佐山哲郎・Studio Ghibli・NDHDMT", "http://www.ghibli.jp/gallery/kokurikozaka012.jpg"],
                                        ["id", "ジブリ", "借りぐらしのアリエッティ", "カルチェラタン", "© 2010 Studio Ghibli・NDHDMTW", "http://www.ghibli.jp/gallery/karigurashi021.jpg"],
                                        ["id", "ジブリ", "崖の上のポニョ", "海の中", "© 2008 Studio Ghibli・NDHDMT", "http://www.ghibli.jp/gallery/ponyo001.jpg"],
                                        ["id", "ジブリ", "ハウルの動く城", "城", "© 2004 Studio Ghibli・NDDMT", "http://www.ghibli.jp/gallery/howl011.jpg"],
                                        ["id", "ジブリ", "猫の恩返し", "ねこの行列", "© 2002 猫乃手堂・Studio Ghibli・NDHMT", "http://www.ghibli.jp/gallery/baron005.jpg"],
                                        ["id", "ジブリ", "千と千尋の神隠し", "湯屋", "© 2001 Studio Ghibli・NDDTM", "http://www.ghibli.jp/gallery/chihiro015.jpg"],
                                        ["id", "ジブリ", "耳をすませば", "ムーン", "© 1995 柊あおい/集英社・Studio Ghibli・NH", "http://www.ghibli.jp/gallery/mimi008.jpg"],
                                        ["id", "ジブリ", "平成狸合戦ぽんぽこ", "戦うタヌキ", "© 1994 畑事務所・Studio Ghibli・NH", "http://www.ghibli.jp/gallery/tanuki001.jpg"],
                                        ["id", "ジブリ", "紅の豚", "サボイアS.21試作戦闘飛行艇", "© 1992 Studio Ghibli・NN", "http://www.ghibli.jp/gallery/porco002.jpg"],
                                        ["id", "ジブリ", "魔女の宅急便", "キキの家", "© 1989 角野栄子・Studio Ghibli・N", "http://www.ghibli.jp/gallery/majo002.jpg"],
                                        ["id", "ジブリ", "となりのトトロ", "おやすみトトロ", "© 1988 Studio Ghibli", "http://www.ghibli.jp/gallery/totoro022.jpg"],
                                        */
                                    ];

                                    // リストセット
                                    for (let i = 0; i < bg.length; i++) {
                                        let opt = document.createElement("option");
                                        opt.value = i;
                                        if (bg[i][0] == false) {
                                            // 表示項目設定
                                            opt.innerText = bg[i][1];
                                        } else {
                                            // 表示項目設定
                                            opt.innerText = bg[i][2] + "：" + bg[i][3];
                                            // id付番
                                            bg[i][0] = bg[i][1] + bg[i][2] + bg[i][3];
                                        }
                                        document.getElementById("wallpaperSector").appendChild(opt);
                                    }

                                    // wallpaperの設定
                                    // 引数：i＝select form option value
                                    function setWallpaper(i) {
                                        // 見出し行選択時
                                        while (bg[i][0] == false) {
                                            if (document.getElementById("wallpaperAuto").checked) {
                                                // Autoモードなら、次項目を選択
                                                i = (i + 1) % bg.length;
                                            } else {
                                                // Autoモードでなければ、処理中止
                                                return;
                                            }
                                        }
                                        document.body.style = 'background:#bbb url("' +
                                            (bg[i][1] == "find47" ?
                                                '//find47.jp/ja/i/' + bg[i][5] + '/image_file' :
                                                bg[i][5]
                                            ) + '");' +
                                            "background-size:cover;" +
                                            "background-repeat: no-repeat; " +
                                            "background-attachment: fixed; " +
                                            "background-position: center center;";
                                        document.getElementById("wallpaperCopyright").innerHTML = "" +
                                            "【現在の設定】<br/>" + bg[i][2] + "：" + bg[i][3] + "<br/>" + bg[i][4];
                                        document.getElementById("wallpaperSector").value = i;
                                        Cookie.set("wallpaperId", bg[i][0], { expires: 14 });
                                    }

                                    // 画像選択イベント
                                    document.getElementById("wallpaperSector").addEventListener('change',
                                        (event) => {
                                            if (bg[document.getElementById("wallpaperSector").value][0] != false) {
                                                document.getElementById("wallpaperAuto").checked = false;
                                                setWallpaper(document.getElementById("wallpaperSector").value);
                                            }
                                        }
                                    );

                                    // Auto用interval関数
                                    let wpAuto = setInterval(function () {
                                        if (document.getElementById("wallpaperAuto").checked) {
                                            setWallpaper(Math.round(Math.random() * (bg.length - 1)));
                                        }
                                    }, 30 * 1000);

                                    // Autoスイッチ操作イベント
                                    document.getElementById("wallpaperAuto").addEventListener('change',
                                        (event) => {
                                            if (document.getElementById("wallpaperAuto").checked) {
                                                Cookie.set("wallpaperAuto", 1, { expires: 14 });
                                                setWallpaper(Math.round(Math.random() * (bg.length - 1)));
                                            } else {
                                                Cookie.set("wallpaperAuto", 0);
                                            }
                                        }
                                    );

                                    // 初期設定（前回値を復元）
                                    window.addEventListener("load", function () {
                                        Cookie.remove("wallpaperIndex");    //古いクッキーさようなら（気が付いたときに消す：20201123）
                                        let id = Cookie.get("wallpaperId");
                                        if (id != undefined) {
                                            // 壁紙復元
                                            for (let i = 0; i < bg.length; i++) {
                                                if (bg[i][0] == id) {
                                                    setWallpaper(i);
                                                    break;
                                                }
                                            }
                                            // Autoモード復元
                                            if (Cookie.get("wallpaperAuto") == 1) {
                                                document.getElementById("wallpaperAuto").checked = true;
                                            }
                                        }
                                    });
                                </script>
                                <p class="card-text">お好きな都道府県の壁紙で、旅行気分だけでもどうぞ。</p>
                                <select class="form-select" id="wallpaperSector"></select>
                                <div class="form-check form-switch d-flex flex-row">
                                    <input class="form-check-input align-self-center" type="checkbox"
                                        id="wallpaperAuto">
                                    <label class="form-check-label align-self-center"
                                        for="wallpaperAuto">Auto(30秒毎に自動変更)</label>　
                                    <a role="button" class="btn btn-outline-primary align-self-center" onclick='
                                    document.getElementById("wallpaperAuto").checked=false;
                                    document.body.style="background:#bbb;";
                                    document.getElementById("wallpaperCopyright").innerHTML="";
                                    '>Reset</a>
                                </div>
                                <div class="card">
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item bg-info" id="wallpaperCopyright"></li>
                                        <li class="list-group-item">
                                            <a href="https://find47.jp">FIND47.JP</a>
                                            <a href="https://creativecommons.org/licenses/by/4.0/deed.ja">
                                                <img src="./pict/by.png" width="80px" alt="CC BY 4.0">
                                            </a>
                                        </li>
                                        <li class="list-group-item d-none">
                                            <a href="http://www.ghibli.jp/">© Studio Ghibli</a>
                                        </li>
                                        <li class="list-group-item bg-secondary d-none">
                                            <small>※ジブリ壁紙はHTTP接続になります</small>
                                        </li>
                                    </ul>
                                </div>

                            </div>
                            <div class="card-footer">
                                <small class="text-muted">本機能はCookieを使用します</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>
</body>

</html>